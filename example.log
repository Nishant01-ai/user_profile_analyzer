INFO:src.utils.log_file:Health Check
INFO:src.utils.log_file:Health Check
INFO:src.utils.log_file:Health Check
INFO:src.utils.log_file:execution started for fetching client info : 1
INFO:src.utils.log_file:client info fetch completed
INFO:src.utils.log_file:getting cluser info 1
INFO:src.utils.log_file:user belongs to 0
INFO:src.utils.log_file:starting process for cutomised content for user
DEBUG:openai._base_client:Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': "{'marketing_content_instruction': 'You are an expert Marketing content creator for Banking Products and services. Use the customer data given containing user Age group, annual income, debt, spending habits to suggest them tailored banking products and services. In the final response just suggest the marketing products and services. Do not provide the summary of user income, expenses or debt in final response. '}"}, {'role': 'user', 'content': "Generate customized marketing email using the given information: {'client_id': 1, 'sum_amount_spent': '29110.22', 'count_amount_spent': '811', 'avg_amount_spent': '35.89422934648582', 'mode_spent': [{'use_chip': 'Online Transaction', 'amount_spent': 7068.34}, {'use_chip': 'Swipe Transaction', 'amount_spent': 22041.88}], 'mode_count': [{'use_chip': 'Online Transaction', 'Num_of_transaction': 327}, {'use_chip': 'Swipe Transaction', 'Num_of_transaction': 484}], 'top_n_merchants': [{'merchant_category': 'Taxicabs and Limousines', 'amount': 6607.86}, {'merchant_category': 'Telecommunication Services', 'amount': 2853.22}, {'merchant_category': 'Money Transfer', 'amount': 2220.0}], 'quarterly_spent': [{'quarter': Period('2019Q1', 'Q-DEC'), 'Amount_Spent': 8826.95}, {'quarter': Period('2019Q2', 'Q-DEC'), 'Amount_Spent': 8113.05}, {'quarter': Period('2019Q3', 'Q-DEC'), 'Amount_Spent': 9837.83}, {'quarter': Period('2019Q4', 'Q-DEC'), 'Amount_Spent': 2332.39}], 'top_n_trnxn_qtr': [{'quarter': Period('2019Q1', 'Q-DEC'), 'merchant_category': 'Taxicabs and Limousines', 'count_trnsxn': 130}, {'quarter': Period('2019Q1', 'Q-DEC'), 'merchant_category': 'Service Stations', 'count_trnsxn': 18}, {'quarter': Period('2019Q1', 'Q-DEC'), 'merchant_category': 'Eating Places and Restaurants', 'count_trnsxn': 11}, {'quarter': Period('2019Q2', 'Q-DEC'), 'merchant_category': 'Taxicabs and Limousines', 'count_trnsxn': 136}, {'quarter': Period('2019Q2', 'Q-DEC'), 'merchant_category': 'Money Transfer', 'count_trnsxn': 16}, {'quarter': Period('2019Q2', 'Q-DEC'), 'merchant_category': 'Service Stations', 'count_trnsxn': 10}, {'quarter': Period('2019Q3', 'Q-DEC'), 'merchant_category': 'Taxicabs and Limousines', 'count_trnsxn': 147}, {'quarter': Period('2019Q3', 'Q-DEC'), 'merchant_category': 'Money Transfer', 'count_trnsxn': 16}, {'quarter': Period('2019Q3', 'Q-DEC'), 'merchant_category': 'Eating Places and Restaurants', 'count_trnsxn': 9}, {'quarter': Period('2019Q4', 'Q-DEC'), 'merchant_category': 'Taxicabs and Limousines', 'count_trnsxn': 47}, {'quarter': Period('2019Q4', 'Q-DEC'), 'merchant_category': 'Automotive Service Shops', 'count_trnsxn': 4}, {'quarter': Period('2019Q4', 'Q-DEC'), 'merchant_category': 'Eating Places and Restaurants', 'count_trnsxn': 4}], 'top_n_store_visits': [{'merchant_category': 'Taxicabs and Limousines', 'count_visits': 460}, {'merchant_category': 'Money Transfer', 'count_visits': 46}, {'merchant_category': 'Service Stations', 'count_visits': 36}], 'spending_summary': [{'spending_category': 'Low', 'count_trxn': 224}, {'spending_category': 'Medium', 'count_trxn': 373}, {'spending_category': 'High', 'count_trxn': 214}], 'cluster_user': 0, 'user_profile_info': {'age_group': '25–69', 'annual_income': 'Low to moderate (20k–48k) in USD', 'total_debt': 'Moderate to high (20k–93k) in USD', 'spending_amount_category': 'Low to moderate (-58 to 160) in USD', 'profile_summary': 'Middle-aged individuals with moderate income and debt.'}}"}], 'model': 'gpt-4o-mini'}}
DEBUG:openai._base_client:Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
DEBUG:httpcore.connection:connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
DEBUG:httpcore.connection:connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000025527AE1150>
DEBUG:httpcore.connection:start_tls.started ssl_context=<ssl.SSLContext object at 0x0000025527B4DDC0> server_hostname='api.openai.com' timeout=5.0
DEBUG:httpcore.connection:start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000025527AE11E0>
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 14 Jan 2025 18:17:53 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'startt-media'), (b'openai-processing-ms', b'5161'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'200000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'199133'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'260ms'), (b'x-request-id', b'req_909f4809c445421bc27bcff774a41324'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=SVEk93GLcvhU5B6S1orwWTtcTjT_yXdyBQvorrhU47I-1736878673-1.0.1.1-..Pvm_TZAb3WA7KVlpN95eQGUeqDm4ggmu24rsGmBD5_b1tTyW8adDi1mC5Bypc4fFJq3C3rbOo2LpZqn3KEwA; path=/; expires=Tue, 14-Jan-25 18:47:53 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=TmL19jA9FRWClOKSHgVhQrQjkcAJK6xAVyoR3P2Byks-1736878673498-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'901f9ffb9ee2b299-MAA'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:openai._base_client:HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 14 Jan 2025 18:17:53 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'startt-media'), ('openai-processing-ms', '5161'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '200000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '199133'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '260ms'), ('x-request-id', 'req_909f4809c445421bc27bcff774a41324'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=SVEk93GLcvhU5B6S1orwWTtcTjT_yXdyBQvorrhU47I-1736878673-1.0.1.1-..Pvm_TZAb3WA7KVlpN95eQGUeqDm4ggmu24rsGmBD5_b1tTyW8adDi1mC5Bypc4fFJq3C3rbOo2LpZqn3KEwA; path=/; expires=Tue, 14-Jan-25 18:47:53 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=TmL19jA9FRWClOKSHgVhQrQjkcAJK6xAVyoR3P2Byks-1736878673498-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '901f9ffb9ee2b299-MAA'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
DEBUG:openai._base_client:request_id: req_909f4809c445421bc27bcff774a41324
INFO:src.utils.log_file:cutomised content for user generated
DEBUG:httpcore.connection:close.started
DEBUG:httpcore.connection:close.complete
INFO:src.utils.log_file:execution started for fetching client info : 1
ERROR:src.utils.log_file:Something went wrong in user info fetch Maximum recursion level reached
INFO:src.utils.log_file:getting cluser info 1
INFO:src.utils.log_file:user belongs to 0
INFO:src.utils.log_file:starting process for cutomised content for user
DEBUG:openai._base_client:Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': "{'marketing_content_instruction': 'You are an expert Marketing content creator for Banking Products and services. Use the customer data given containing user Age group, annual income, debt, spending habits to suggest them tailored banking products and services. In the final response just suggest the marketing products and services. Do not provide the summary of user income, expenses or debt in final response. '}"}, {'role': 'user', 'content': "Generate customized marketing email using the given information: {'client_id': 1, 'sum_amount_spent': 'NA', 'count_amount_spent': 'NA', 'avg_amount_spent': 'NA', 'mode_spent': 'NA', 'mode_count': 'NA', 'top_n_merchants': 'NA', 'quarterly_spent': 'NA', 'top_n_trnxn_qtr': 'NA', 'top_n_store_visits': 'NA', 'spending_summary': 'NA', 'cluster_user': 0, 'user_profile_info': {'age_group': '25–69', 'annual_income': 'Low to moderate (20k–48k) in USD', 'total_debt': 'Moderate to high (20k–93k) in USD', 'spending_amount_category': 'Low to moderate (-58 to 160) in USD', 'profile_summary': 'Middle-aged individuals with moderate income and debt.'}}"}], 'model': 'gpt-4o-mini'}}
DEBUG:openai._base_client:Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
DEBUG:httpcore.connection:connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
DEBUG:httpcore.connection:connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001D18C3D88E0>
DEBUG:httpcore.connection:start_tls.started ssl_context=<ssl.SSLContext object at 0x000001D18C42D9C0> server_hostname='api.openai.com' timeout=5.0
DEBUG:httpcore.connection:start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001D18C3D8970>
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 14 Jan 2025 18:21:48 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'startt-media'), (b'openai-processing-ms', b'4624'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'200000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'199716'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'85ms'), (b'x-request-id', b'req_8ed07f5c2b78118f564acad4716f7c8d'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=bIKbRDyu.ftb1Of7FtHbOsX_VzDXVWi7Q9GgFt.gH8U-1736878908-1.0.1.1-Za3EMfui05l3GpcxZZH6hECO9Kq3LlL.kfjVgx9qERrO4DDZwY7fm4gvBKw_VEXYcf8rzf6PIb7_B_JrPOTR6w; path=/; expires=Tue, 14-Jan-25 18:51:48 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=ZWG.3fIyLWgJJBZWm6a3qnWTAJkp1jR5aTt2z3y1fog-1736878908068-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'901fa5b4b9e59377-MAA'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:openai._base_client:HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 14 Jan 2025 18:21:48 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'startt-media'), ('openai-processing-ms', '4624'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '200000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '199716'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '85ms'), ('x-request-id', 'req_8ed07f5c2b78118f564acad4716f7c8d'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=bIKbRDyu.ftb1Of7FtHbOsX_VzDXVWi7Q9GgFt.gH8U-1736878908-1.0.1.1-Za3EMfui05l3GpcxZZH6hECO9Kq3LlL.kfjVgx9qERrO4DDZwY7fm4gvBKw_VEXYcf8rzf6PIb7_B_JrPOTR6w; path=/; expires=Tue, 14-Jan-25 18:51:48 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=ZWG.3fIyLWgJJBZWm6a3qnWTAJkp1jR5aTt2z3y1fog-1736878908068-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '901fa5b4b9e59377-MAA'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
DEBUG:openai._base_client:request_id: req_8ed07f5c2b78118f564acad4716f7c8d
INFO:src.utils.log_file:cutomised content for user generated
DEBUG:httpcore.connection:close.started
DEBUG:httpcore.connection:close.complete
INFO:src.utils.log_file:execution started for fetching client info : 1
ERROR:src.utils.log_file:Something went wrong in user info fetch Maximum recursion level reached
INFO:src.utils.log_file:getting cluser info 1
INFO:src.utils.log_file:user belongs to 0
INFO:src.utils.log_file:starting process for cutomised content for user
DEBUG:openai._base_client:Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': "{'marketing_content_instruction': 'You are an expert Marketing content creator for Banking Products and services. Use the customer data given containing user Age group, annual income, debt, spending habits to suggest them tailored banking products and services. In the final response just suggest the marketing products and services. Do not provide the summary of user income, expenses or debt in final response. '}"}, {'role': 'user', 'content': "Generate customized marketing email using the given information: {'client_id': 1, 'sum_amount_spent': 'NA', 'count_amount_spent': 'NA', 'avg_amount_spent': 'NA', 'mode_spent': 'NA', 'mode_count': 'NA', 'top_n_merchants': 'NA', 'quarterly_spent': 'NA', 'top_n_trnxn_qtr': 'NA', 'top_n_store_visits': 'NA', 'spending_summary': 'NA', 'cluster_user': 0, 'user_profile_info': {'age_group': '25–69', 'annual_income': 'Low to moderate (20k–48k) in USD', 'total_debt': 'Moderate to high (20k–93k) in USD', 'spending_amount_category': 'Low to moderate (-58 to 160) in USD', 'profile_summary': 'Middle-aged individuals with moderate income and debt.'}}"}], 'model': 'gpt-4o-mini'}}
DEBUG:openai._base_client:Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
DEBUG:httpcore.connection:connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
DEBUG:httpcore.connection:connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001F98BA2C880>
DEBUG:httpcore.connection:start_tls.started ssl_context=<ssl.SSLContext object at 0x000001F98BA859C0> server_hostname='api.openai.com' timeout=5.0
DEBUG:httpcore.connection:start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001F98BA2C910>
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 14 Jan 2025 18:22:52 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'startt-media'), (b'openai-processing-ms', b'6118'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'200000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'199716'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'85ms'), (b'x-request-id', b'req_dc4a83819d0dd260ba5a476d70b28ccf'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=luxoGopUDDStyL3t90ZJBTjEQ7FYqkgYzsxwiVf58yw-1736878972-1.0.1.1-RzVJSoJek6YzOC1dex.S3xHvdtHwXDwTavVK.DnZ65bj.7Hu06_JUSRAcWdSN09vWAGHB7oM3fZoK1brREAhtA; path=/; expires=Tue, 14-Jan-25 18:52:52 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=OSCQEtkNIaxsAJ9VLJIQd.0DulCDBAZH53jgVvkBuQo-1736878972899-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'901fa744cea6a8f5-MAA'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:openai._base_client:HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 14 Jan 2025 18:22:52 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'startt-media'), ('openai-processing-ms', '6118'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '200000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '199716'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '85ms'), ('x-request-id', 'req_dc4a83819d0dd260ba5a476d70b28ccf'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=luxoGopUDDStyL3t90ZJBTjEQ7FYqkgYzsxwiVf58yw-1736878972-1.0.1.1-RzVJSoJek6YzOC1dex.S3xHvdtHwXDwTavVK.DnZ65bj.7Hu06_JUSRAcWdSN09vWAGHB7oM3fZoK1brREAhtA; path=/; expires=Tue, 14-Jan-25 18:52:52 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=OSCQEtkNIaxsAJ9VLJIQd.0DulCDBAZH53jgVvkBuQo-1736878972899-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '901fa744cea6a8f5-MAA'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
DEBUG:openai._base_client:request_id: req_dc4a83819d0dd260ba5a476d70b28ccf
INFO:src.utils.log_file:cutomised content for user generated
INFO:src.utils.log_file:execution started for fetching client info : 1
ERROR:src.utils.log_file:Something went wrong in user info fetch Maximum recursion level reached
INFO:src.utils.log_file:getting cluser info 1
INFO:src.utils.log_file:user belongs to 0
INFO:src.utils.log_file:starting process for cutomised content for user
DEBUG:openai._base_client:Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': "{'marketing_content_instruction': 'You are an expert Marketing content creator for Banking Products and services. Use the customer data given containing user Age group, annual income, debt, spending habits to suggest them tailored banking products and services. In the final response just suggest the marketing products and services. Do not provide the summary of user income, expenses or debt in final response. '}"}, {'role': 'user', 'content': "Generate customized marketing email using the given information: {'client_id': 1, 'sum_amount_spent': 'NA', 'count_amount_spent': 'NA', 'avg_amount_spent': 'NA', 'mode_spent': 'NA', 'mode_count': 'NA', 'top_n_merchants': 'NA', 'quarterly_spent': 'NA', 'top_n_trnxn_qtr': 'NA', 'top_n_store_visits': 'NA', 'spending_summary': 'NA', 'cluster_user': 0, 'user_profile_info': {'age_group': '25–69', 'annual_income': 'Low to moderate (20k–48k) in USD', 'total_debt': 'Moderate to high (20k–93k) in USD', 'spending_amount_category': 'Low to moderate (-58 to 160) in USD', 'profile_summary': 'Middle-aged individuals with moderate income and debt.'}}"}], 'model': 'gpt-4o-mini'}}
DEBUG:openai._base_client:Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
DEBUG:httpcore.connection:connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
DEBUG:httpcore.connection:connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001F988ECA800>
DEBUG:httpcore.connection:start_tls.started ssl_context=<ssl.SSLContext object at 0x000001F98BA861C0> server_hostname='api.openai.com' timeout=5.0
DEBUG:httpcore.connection:start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001F988ECA590>
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 14 Jan 2025 18:24:03 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'startt-media'), (b'openai-processing-ms', b'8065'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'200000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'199716'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'85ms'), (b'x-request-id', b'req_69bdf54107d3a6a43f53a00409ddca4e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=DKOyt1zTQFO1BtwrgZ8Y9yB6q3C2ZO0TW5EJcyfIwjo-1736879043-1.0.1.1-Ql7HjTVLGcDx6uxvggBkhyPsk4_TbTq3gkhnuP9tOw5pteo70EyKT7ST6ZnHsfxec53mfHfWZtvDlmA8WfAURw; path=/; expires=Tue, 14-Jan-25 18:54:03 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=DZdAMVQwy54xa3Leu_XG8oh4JqvmFxrmN1srTnLVyCA-1736879043037-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'901fa8eb6b879380-MAA'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:openai._base_client:HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 14 Jan 2025 18:24:03 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'startt-media'), ('openai-processing-ms', '8065'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '200000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '199716'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '85ms'), ('x-request-id', 'req_69bdf54107d3a6a43f53a00409ddca4e'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=DKOyt1zTQFO1BtwrgZ8Y9yB6q3C2ZO0TW5EJcyfIwjo-1736879043-1.0.1.1-Ql7HjTVLGcDx6uxvggBkhyPsk4_TbTq3gkhnuP9tOw5pteo70EyKT7ST6ZnHsfxec53mfHfWZtvDlmA8WfAURw; path=/; expires=Tue, 14-Jan-25 18:54:03 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=DZdAMVQwy54xa3Leu_XG8oh4JqvmFxrmN1srTnLVyCA-1736879043037-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '901fa8eb6b879380-MAA'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
DEBUG:openai._base_client:request_id: req_69bdf54107d3a6a43f53a00409ddca4e
INFO:src.utils.log_file:cutomised content for user generated
DEBUG:httpcore.connection:close.started
DEBUG:httpcore.connection:close.complete
DEBUG:httpcore.connection:close.started
DEBUG:httpcore.connection:close.complete
INFO:src.utils.log_file:execution started for fetching client info : 1
ERROR:src.utils.log_file:Something went wrong in user info fetch DataFrame.to_dict() got an unexpected keyword argument 'date_format'
INFO:src.utils.log_file:getting cluser info 1
INFO:src.utils.log_file:user belongs to 0
INFO:src.utils.log_file:starting process for cutomised content for user
DEBUG:openai._base_client:Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': "{'marketing_content_instruction': 'You are an expert Marketing content creator for Banking Products and services. Use the customer data given containing user Age group, annual income, debt, spending habits to suggest them tailored banking products and services. In the final response just suggest the marketing products and services. Do not provide the summary of user income, expenses or debt in final response. '}"}, {'role': 'user', 'content': "Generate customized marketing email using the given information: {'client_id': 1, 'sum_amount_spent': 'NA', 'count_amount_spent': 'NA', 'avg_amount_spent': 'NA', 'mode_spent': 'NA', 'mode_count': 'NA', 'top_n_merchants': 'NA', 'quarterly_spent': 'NA', 'top_n_trnxn_qtr': 'NA', 'top_n_store_visits': 'NA', 'spending_summary': 'NA', 'cluster_user': 0, 'user_profile_info': {'age_group': '25–69', 'annual_income': 'Low to moderate (20k–48k) in USD', 'total_debt': 'Moderate to high (20k–93k) in USD', 'spending_amount_category': 'Low to moderate (-58 to 160) in USD', 'profile_summary': 'Middle-aged individuals with moderate income and debt.'}}"}], 'model': 'gpt-4o-mini'}}
DEBUG:openai._base_client:Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
DEBUG:httpcore.connection:connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
DEBUG:httpcore.connection:connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000015B1956D4E0>
DEBUG:httpcore.connection:start_tls.started ssl_context=<ssl.SSLContext object at 0x0000015B195C5BC0> server_hostname='api.openai.com' timeout=5.0
DEBUG:httpcore.connection:start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000015B1956D570>
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 14 Jan 2025 18:26:26 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'startt-media'), (b'openai-processing-ms', b'4791'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'200000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'199716'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'85ms'), (b'x-request-id', b'req_5377f4205861fecf53ceeec2cf8b3151'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=LMRwYXb2x8WA76POhMOfj7u6e_Ss8SV2AQD1ujV_Lrw-1736879186-1.0.1.1-y7e4zyto92q71xelyLrwKLRR.fh8nYOz5i2EH4IaIZqI1bresljyiMJNmnpPU.MrtAgf3cYPnSN9Bnrem9IKRQ; path=/; expires=Tue, 14-Jan-25 18:56:26 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=xIhJ4T2G.8l2pfJGnEYX4q0MW63Qto70h2bPQHz1BZA-1736879186260-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'901fac825a329371-MAA'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:openai._base_client:HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 14 Jan 2025 18:26:26 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'startt-media'), ('openai-processing-ms', '4791'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '200000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '199716'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '85ms'), ('x-request-id', 'req_5377f4205861fecf53ceeec2cf8b3151'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=LMRwYXb2x8WA76POhMOfj7u6e_Ss8SV2AQD1ujV_Lrw-1736879186-1.0.1.1-y7e4zyto92q71xelyLrwKLRR.fh8nYOz5i2EH4IaIZqI1bresljyiMJNmnpPU.MrtAgf3cYPnSN9Bnrem9IKRQ; path=/; expires=Tue, 14-Jan-25 18:56:26 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=xIhJ4T2G.8l2pfJGnEYX4q0MW63Qto70h2bPQHz1BZA-1736879186260-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '901fac825a329371-MAA'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
DEBUG:openai._base_client:request_id: req_5377f4205861fecf53ceeec2cf8b3151
INFO:src.utils.log_file:cutomised content for user generated
DEBUG:httpcore.connection:close.started
DEBUG:httpcore.connection:close.complete
INFO:src.utils.log_file:execution started for fetching client info : 1
INFO:src.utils.log_file:client info fetch completed
INFO:src.utils.log_file:getting cluser info 1
INFO:src.utils.log_file:user belongs to 0
INFO:src.utils.log_file:starting process for cutomised content for user
DEBUG:openai._base_client:Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': "{'marketing_content_instruction': 'You are an expert Marketing content creator for Banking Products and services. Use the customer data given containing user Age group, annual income, debt, spending habits to suggest them tailored banking products and services. In the final response just suggest the marketing products and services. Do not provide the summary of user income, expenses or debt in final response. '}"}, {'role': 'user', 'content': "Generate customized marketing email using the given information: {'client_id': 1, 'sum_amount_spent': '29110.22', 'count_amount_spent': '811', 'avg_amount_spent': '35.89422934648582', 'mode_spent': [{'use_chip': 'Online Transaction', 'amount_spent': 7068.34}, {'use_chip': 'Swipe Transaction', 'amount_spent': 22041.88}], 'mode_count': [{'use_chip': 'Online Transaction', 'Num_of_transaction': 327}, {'use_chip': 'Swipe Transaction', 'Num_of_transaction': 484}], 'top_n_merchants': [{'merchant_category': 'Taxicabs and Limousines', 'amount': 6607.86}, {'merchant_category': 'Telecommunication Services', 'amount': 2853.22}, {'merchant_category': 'Money Transfer', 'amount': 2220.0}], 'quarterly_spent': [{'quarter': '2019Q1', 'Amount_Spent': 8826.95}, {'quarter': '2019Q2', 'Amount_Spent': 8113.05}, {'quarter': '2019Q3', 'Amount_Spent': 9837.83}, {'quarter': '2019Q4', 'Amount_Spent': 2332.39}], 'top_n_trnxn_qtr': [{'quarter': '2019Q1', 'merchant_category': 'Taxicabs and Limousines', 'count_trnsxn': 130}, {'quarter': '2019Q1', 'merchant_category': 'Service Stations', 'count_trnsxn': 18}, {'quarter': '2019Q1', 'merchant_category': 'Eating Places and Restaurants', 'count_trnsxn': 11}, {'quarter': '2019Q2', 'merchant_category': 'Taxicabs and Limousines', 'count_trnsxn': 136}, {'quarter': '2019Q2', 'merchant_category': 'Money Transfer', 'count_trnsxn': 16}, {'quarter': '2019Q2', 'merchant_category': 'Service Stations', 'count_trnsxn': 10}, {'quarter': '2019Q3', 'merchant_category': 'Taxicabs and Limousines', 'count_trnsxn': 147}, {'quarter': '2019Q3', 'merchant_category': 'Money Transfer', 'count_trnsxn': 16}, {'quarter': '2019Q3', 'merchant_category': 'Eating Places and Restaurants', 'count_trnsxn': 9}, {'quarter': '2019Q4', 'merchant_category': 'Taxicabs and Limousines', 'count_trnsxn': 47}, {'quarter': '2019Q4', 'merchant_category': 'Automotive Service Shops', 'count_trnsxn': 4}, {'quarter': '2019Q4', 'merchant_category': 'Eating Places and Restaurants', 'count_trnsxn': 4}], 'top_n_store_visits': [{'merchant_category': 'Taxicabs and Limousines', 'count_visits': 460}, {'merchant_category': 'Money Transfer', 'count_visits': 46}, {'merchant_category': 'Service Stations', 'count_visits': 36}], 'spending_summary': [{'spending_category': 'Low', 'count_trxn': 224}, {'spending_category': 'Medium', 'count_trxn': 373}, {'spending_category': 'High', 'count_trxn': 214}], 'cluster_user': 0, 'user_profile_info': {'age_group': '25–69', 'annual_income': 'Low to moderate (20k–48k) in USD', 'total_debt': 'Moderate to high (20k–93k) in USD', 'spending_amount_category': 'Low to moderate (-58 to 160) in USD', 'profile_summary': 'Middle-aged individuals with moderate income and debt.'}}"}], 'model': 'gpt-4o-mini'}}
DEBUG:openai._base_client:Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
DEBUG:httpcore.connection:connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
DEBUG:httpcore.connection:connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002B3C7108E80>
DEBUG:httpcore.connection:start_tls.started ssl_context=<ssl.SSLContext object at 0x000002B3C7179F40> server_hostname='api.openai.com' timeout=5.0
DEBUG:httpcore.connection:start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002B3C7108F10>
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 14 Jan 2025 18:29:30 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'startt-media'), (b'openai-processing-ms', b'4719'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'200000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'199201'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'239ms'), (b'x-request-id', b'req_e34675ee834f0f8bbc248788b0ac1b1e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=uRZvDiDF5VCvehznhihA.eSvjNLcu.1XVuebBjVUjqU-1736879370-1.0.1.1-qlso2sQTNOZ_OvFNoMEClbowp5TE0WMsrxl0GG9hy6cieQOB36Rtq6o58eqOQJTuttjh5W637MbtCbEobiUQmg; path=/; expires=Tue, 14-Jan-25 18:59:30 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=Hy0BNoHe.cWKEnMmkaiP6VCOGoi4wIbIJjjGVuFLSn8-1736879370466-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'901fb0fe3ccd9377-MAA'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:openai._base_client:HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 14 Jan 2025 18:29:30 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'startt-media'), ('openai-processing-ms', '4719'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '200000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '199201'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '239ms'), ('x-request-id', 'req_e34675ee834f0f8bbc248788b0ac1b1e'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=uRZvDiDF5VCvehznhihA.eSvjNLcu.1XVuebBjVUjqU-1736879370-1.0.1.1-qlso2sQTNOZ_OvFNoMEClbowp5TE0WMsrxl0GG9hy6cieQOB36Rtq6o58eqOQJTuttjh5W637MbtCbEobiUQmg; path=/; expires=Tue, 14-Jan-25 18:59:30 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=Hy0BNoHe.cWKEnMmkaiP6VCOGoi4wIbIJjjGVuFLSn8-1736879370466-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '901fb0fe3ccd9377-MAA'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
DEBUG:openai._base_client:request_id: req_e34675ee834f0f8bbc248788b0ac1b1e
INFO:src.utils.log_file:cutomised content for user generated
INFO:src.utils.log_file:execution started for fetching client info : 2
INFO:src.utils.log_file:client info fetch completed
INFO:src.utils.log_file:getting cluser info 2
INFO:src.utils.log_file:user belongs to 2
INFO:src.utils.log_file:starting process for cutomised content for user
DEBUG:openai._base_client:Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': "{'marketing_content_instruction': 'You are an expert Marketing content creator for Banking Products and services. Use the customer data given containing user Age group, annual income, debt, spending habits to suggest them tailored banking products and services. In the final response just suggest the marketing products and services. Do not provide the summary of user income, expenses or debt in final response. '}"}, {'role': 'user', 'content': "Generate customized marketing email using the given information: {'client_id': 2, 'sum_amount_spent': '23980.379999999997', 'count_amount_spent': '911', 'avg_amount_spent': '26.323139407244785', 'mode_spent': [{'use_chip': 'Chip Transaction', 'amount_spent': 15621.7}, {'use_chip': 'Online Transaction', 'amount_spent': 2515.67}, {'use_chip': 'Swipe Transaction', 'amount_spent': 5843.01}], 'mode_count': [{'use_chip': 'Chip Transaction', 'Num_of_transaction': 619}, {'use_chip': 'Online Transaction', 'Num_of_transaction': 46}, {'use_chip': 'Swipe Transaction', 'Num_of_transaction': 246}], 'top_n_merchants': [{'merchant_category': 'Grocery Stores, Supermarkets', 'amount': 2068.29}, {'merchant_category': 'Drug Stores and Pharmacies', 'amount': 1781.71}, {'merchant_category': 'Wholesale Clubs', 'amount': 1773.41}], 'quarterly_spent': [{'quarter': '2019Q1', 'Amount_Spent': 7977.27}, {'quarter': '2019Q2', 'Amount_Spent': 6929.12}, {'quarter': '2019Q3', 'Amount_Spent': 7012.84}, {'quarter': '2019Q4', 'Amount_Spent': 2061.15}], 'top_n_trnxn_qtr': [{'quarter': '2019Q1', 'merchant_category': 'Postal Services - Government Only', 'count_trnsxn': 37}, {'quarter': '2019Q1', 'merchant_category': 'Motor Freight Carriers and Trucking', 'count_trnsxn': 35}, {'quarter': '2019Q1', 'merchant_category': 'Service Stations', 'count_trnsxn': 27}, {'quarter': '2019Q2', 'merchant_category': 'Postal Services - Government Only', 'count_trnsxn': 42}, {'quarter': '2019Q2', 'merchant_category': 'Motor Freight Carriers and Trucking', 'count_trnsxn': 30}, {'quarter': '2019Q2', 'merchant_category': 'Service Stations', 'count_trnsxn': 29}, {'quarter': '2019Q3', 'merchant_category': 'Motor Freight Carriers and Trucking', 'count_trnsxn': 42}, {'quarter': '2019Q3', 'merchant_category': 'Postal Services - Government Only', 'count_trnsxn': 35}, {'quarter': '2019Q3', 'merchant_category': 'Department Stores', 'count_trnsxn': 25}, {'quarter': '2019Q4', 'merchant_category': 'Postal Services - Government Only', 'count_trnsxn': 17}, {'quarter': '2019Q4', 'merchant_category': 'Service Stations', 'count_trnsxn': 13}, {'quarter': '2019Q4', 'merchant_category': 'Motor Freight Carriers and Trucking', 'count_trnsxn': 10}], 'top_n_store_visits': [{'merchant_category': 'Postal Services - Government Only', 'count_visits': 131}, {'merchant_category': 'Motor Freight Carriers and Trucking', 'count_visits': 117}, {'merchant_category': 'Service Stations', 'count_visits': 86}], 'spending_summary': [{'spending_category': 'Low', 'count_trxn': 349}, {'spending_category': 'Medium', 'count_trxn': 406}, {'spending_category': 'High', 'count_trxn': 156}], 'cluster_user': 2, 'user_profile_info': {'age_group': '40–98', 'annual_income': 'Low to moderate (600–67k) in USD', 'total_debt': 'Low to moderate (0–30k) in USD', 'spending_amount_category': 'Low to moderate (1–160) in USD', 'profile_summary': 'Older individuals with low income and low debt.'}}"}], 'model': 'gpt-4o-mini'}}
DEBUG:openai._base_client:Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
DEBUG:httpcore.connection:connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
DEBUG:httpcore.connection:connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002B3C6A5AD70>
DEBUG:httpcore.connection:start_tls.started ssl_context=<ssl.SSLContext object at 0x000002B3C7179CC0> server_hostname='api.openai.com' timeout=5.0
DEBUG:httpcore.connection:start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002B3C6A5AB00>
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 14 Jan 2025 18:30:20 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'startt-media'), (b'openai-processing-ms', b'23433'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'200000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'199143'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'256ms'), (b'x-request-id', b'req_f90126be1dd153cb76918dee147ddd28'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=5PyUScfEON5gQBFIucfNbgyhQzup8P9_kBoDlY9ayrI-1736879420-1.0.1.1-o2wy5ysv_Is7tqHAkAGnxGju8DYEor_yEtsdZemKIXD_tooR.ZpkhIsc2FBrbdA2Xu4IXFUNs_aU7bn045cVYw; path=/; expires=Tue, 14-Jan-25 19:00:20 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=wex7hOKO6NgxCxNsHwPmI_2pyy0ScA6XOEeYTHwx.M4-1736879420911-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'901fb1c4ddec9365-MAA'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:openai._base_client:HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 14 Jan 2025 18:30:20 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'startt-media'), ('openai-processing-ms', '23433'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '200000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '199143'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '256ms'), ('x-request-id', 'req_f90126be1dd153cb76918dee147ddd28'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=5PyUScfEON5gQBFIucfNbgyhQzup8P9_kBoDlY9ayrI-1736879420-1.0.1.1-o2wy5ysv_Is7tqHAkAGnxGju8DYEor_yEtsdZemKIXD_tooR.ZpkhIsc2FBrbdA2Xu4IXFUNs_aU7bn045cVYw; path=/; expires=Tue, 14-Jan-25 19:00:20 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=wex7hOKO6NgxCxNsHwPmI_2pyy0ScA6XOEeYTHwx.M4-1736879420911-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '901fb1c4ddec9365-MAA'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
DEBUG:openai._base_client:request_id: req_f90126be1dd153cb76918dee147ddd28
INFO:src.utils.log_file:cutomised content for user generated
DEBUG:httpcore.connection:close.started
DEBUG:httpcore.connection:close.complete
DEBUG:httpcore.connection:close.started
DEBUG:httpcore.connection:close.complete
INFO:src.utils.log_file:execution started for fetching client info : 3
INFO:src.utils.log_file:client info fetch completed
INFO:src.utils.log_file:getting cluser info 3
INFO:src.utils.log_file:user belongs to 2
INFO:src.utils.log_file:starting process for cutomised content for user
DEBUG:openai._base_client:Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': "{'marketing_content_instruction': 'You are an expert Marketing content creator for Banking Products and services. Use the customer data given containing user Age group, annual income, debt, spending habits to suggest them tailored banking products and services. In the final response just suggest the marketing products and services. Do not provide the summary of user income, expenses or debt in final response. '}"}, {'role': 'user', 'content': "Generate customized marketing email using the given information: {'client_id': 3, 'sum_amount_spent': '24596.65', 'count_amount_spent': '504', 'avg_amount_spent': '48.80287698412699', 'mode_spent': [{'use_chip': 'Chip Transaction', 'amount_spent': 12514.01}, {'use_chip': 'Online Transaction', 'amount_spent': 2665.7200000000003}, {'use_chip': 'Swipe Transaction', 'amount_spent': 9416.92}], 'mode_count': [{'use_chip': 'Chip Transaction', 'Num_of_transaction': 212}, {'use_chip': 'Online Transaction', 'Num_of_transaction': 55}, {'use_chip': 'Swipe Transaction', 'Num_of_transaction': 237}], 'top_n_merchants': [{'merchant_category': 'Grocery Stores, Supermarkets', 'amount': 3961.14}, {'merchant_category': 'Wholesale Clubs', 'amount': 3711.96}, {'merchant_category': 'Drug Stores and Pharmacies', 'amount': 3378.69}], 'quarterly_spent': [{'quarter': '2019Q1', 'Amount_Spent': 7295.45}, {'quarter': '2019Q2', 'Amount_Spent': 7489.58}, {'quarter': '2019Q3', 'Amount_Spent': 7507.94}, {'quarter': '2019Q4', 'Amount_Spent': 2303.68}], 'top_n_trnxn_qtr': [{'quarter': '2019Q1', 'merchant_category': 'Drug Stores and Pharmacies', 'count_trnsxn': 25}, {'quarter': '2019Q1', 'merchant_category': 'Wholesale Clubs', 'count_trnsxn': 25}, {'quarter': '2019Q1', 'merchant_category': 'Department Stores', 'count_trnsxn': 20}, {'quarter': '2019Q2', 'merchant_category': 'Wholesale Clubs', 'count_trnsxn': 23}, {'quarter': '2019Q2', 'merchant_category': 'Grocery Stores, Supermarkets', 'count_trnsxn': 21}, {'quarter': '2019Q2', 'merchant_category': 'Drug Stores and Pharmacies', 'count_trnsxn': 18}, {'quarter': '2019Q3', 'merchant_category': 'Grocery Stores, Supermarkets', 'count_trnsxn': 25}, {'quarter': '2019Q3', 'merchant_category': 'Wholesale Clubs', 'count_trnsxn': 24}, {'quarter': '2019Q3', 'merchant_category': 'Drug Stores and Pharmacies', 'count_trnsxn': 21}, {'quarter': '2019Q4', 'merchant_category': 'Grocery Stores, Supermarkets', 'count_trnsxn': 13}, {'quarter': '2019Q4', 'merchant_category': 'Drug Stores and Pharmacies', 'count_trnsxn': 8}, {'quarter': '2019Q4', 'merchant_category': 'Automotive Service Shops', 'count_trnsxn': 6}], 'top_n_store_visits': [{'merchant_category': 'Grocery Stores, Supermarkets', 'count_visits': 79}, {'merchant_category': 'Wholesale Clubs', 'count_visits': 78}, {'merchant_category': 'Drug Stores and Pharmacies', 'count_visits': 72}], 'spending_summary': [{'spending_category': 'Low', 'count_trxn': 62}, {'spending_category': 'Medium', 'count_trxn': 158}, {'spending_category': 'High', 'count_trxn': 284}], 'cluster_user': 2, 'user_profile_info': {'age_group': '40–98', 'annual_income': 'Low to moderate (600–67k) in USD', 'total_debt': 'Low to moderate (0–30k) in USD', 'spending_amount_category': 'Low to moderate (1–160) in USD', 'profile_summary': 'Older individuals with low income and low debt.'}}"}], 'model': 'gpt-4o-mini'}}
DEBUG:openai._base_client:Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
DEBUG:httpcore.connection:connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
DEBUG:httpcore.connection:connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001700FF98EB0>
DEBUG:httpcore.connection:start_tls.started ssl_context=<ssl.SSLContext object at 0x0000017010002040> server_hostname='api.openai.com' timeout=5.0
DEBUG:httpcore.connection:start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001700FF98F40>
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 14 Jan 2025 18:34:13 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'startt-media'), (b'openai-processing-ms', b'5546'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'200000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'199165'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'250ms'), (b'x-request-id', b'req_6a39a2f83d81e71ab1b2b9505738ebf7'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=76_RVTsOsOAgNTF8hXUlv5OUXKOJM12._HKYLNzkVPQ-1736879653-1.0.1.1-Y3rmTRWRr.ee53H1EV3OnjWtYipvg6t3Tlq2mpAsMyc8J90JKhSregaIcKXpZuYg5_NOVBmW2YMEiHol3c4FOw; path=/; expires=Tue, 14-Jan-25 19:04:13 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=IHQ7XP2M8kd8iXue76uWTlayIf62nD5aoqIOrxC15QE-1736879653537-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'901fb7e629389373-MAA'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:openai._base_client:HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 14 Jan 2025 18:34:13 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'startt-media'), ('openai-processing-ms', '5546'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '200000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '199165'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '250ms'), ('x-request-id', 'req_6a39a2f83d81e71ab1b2b9505738ebf7'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=76_RVTsOsOAgNTF8hXUlv5OUXKOJM12._HKYLNzkVPQ-1736879653-1.0.1.1-Y3rmTRWRr.ee53H1EV3OnjWtYipvg6t3Tlq2mpAsMyc8J90JKhSregaIcKXpZuYg5_NOVBmW2YMEiHol3c4FOw; path=/; expires=Tue, 14-Jan-25 19:04:13 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=IHQ7XP2M8kd8iXue76uWTlayIf62nD5aoqIOrxC15QE-1736879653537-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '901fb7e629389373-MAA'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
DEBUG:openai._base_client:request_id: req_6a39a2f83d81e71ab1b2b9505738ebf7
INFO:src.utils.log_file:cutomised content for user generated
DEBUG:httpcore.connection:close.started
DEBUG:httpcore.connection:close.complete
INFO:src.utils.log_file:execution started for fetching client info : 3
INFO:src.utils.log_file:client info fetch completed
INFO:src.utils.log_file:getting cluser info 3
INFO:src.utils.log_file:user belongs to 2
INFO:src.utils.log_file:starting process for cutomised content for user
DEBUG:openai._base_client:Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '{\'marketing_content_instruction\': "You are an expert Marketing content creator for Banking Products and services. Use the customer data given containing user Age group, annual income, debt, spending habits to suggest them tailored banking products and services via email. In the final response suggest the marketing products and services, along with a attractive Tag Line for suggested products & services. Do not provide the summary of user income, expenses or debt in final response. Format the response in a dictionary {\'email_body\': email, \'tag_line\': Tagline}"}'}, {'role': 'user', 'content': "Generate customized marketing email using the given information: {'client_id': 3, 'sum_amount_spent': '24596.65', 'count_amount_spent': '504', 'avg_amount_spent': '48.80287698412699', 'mode_spent': [{'use_chip': 'Chip Transaction', 'amount_spent': 12514.01}, {'use_chip': 'Online Transaction', 'amount_spent': 2665.7200000000003}, {'use_chip': 'Swipe Transaction', 'amount_spent': 9416.92}], 'mode_count': [{'use_chip': 'Chip Transaction', 'Num_of_transaction': 212}, {'use_chip': 'Online Transaction', 'Num_of_transaction': 55}, {'use_chip': 'Swipe Transaction', 'Num_of_transaction': 237}], 'top_n_merchants': [{'merchant_category': 'Grocery Stores, Supermarkets', 'amount': 3961.14}, {'merchant_category': 'Wholesale Clubs', 'amount': 3711.96}, {'merchant_category': 'Drug Stores and Pharmacies', 'amount': 3378.69}], 'quarterly_spent': [{'quarter': '2019Q1', 'Amount_Spent': 7295.45}, {'quarter': '2019Q2', 'Amount_Spent': 7489.58}, {'quarter': '2019Q3', 'Amount_Spent': 7507.94}, {'quarter': '2019Q4', 'Amount_Spent': 2303.68}], 'top_n_trnxn_qtr': [{'quarter': '2019Q1', 'merchant_category': 'Drug Stores and Pharmacies', 'count_trnsxn': 25}, {'quarter': '2019Q1', 'merchant_category': 'Wholesale Clubs', 'count_trnsxn': 25}, {'quarter': '2019Q1', 'merchant_category': 'Department Stores', 'count_trnsxn': 20}, {'quarter': '2019Q2', 'merchant_category': 'Wholesale Clubs', 'count_trnsxn': 23}, {'quarter': '2019Q2', 'merchant_category': 'Grocery Stores, Supermarkets', 'count_trnsxn': 21}, {'quarter': '2019Q2', 'merchant_category': 'Drug Stores and Pharmacies', 'count_trnsxn': 18}, {'quarter': '2019Q3', 'merchant_category': 'Grocery Stores, Supermarkets', 'count_trnsxn': 25}, {'quarter': '2019Q3', 'merchant_category': 'Wholesale Clubs', 'count_trnsxn': 24}, {'quarter': '2019Q3', 'merchant_category': 'Drug Stores and Pharmacies', 'count_trnsxn': 21}, {'quarter': '2019Q4', 'merchant_category': 'Grocery Stores, Supermarkets', 'count_trnsxn': 13}, {'quarter': '2019Q4', 'merchant_category': 'Drug Stores and Pharmacies', 'count_trnsxn': 8}, {'quarter': '2019Q4', 'merchant_category': 'Automotive Service Shops', 'count_trnsxn': 6}], 'top_n_store_visits': [{'merchant_category': 'Grocery Stores, Supermarkets', 'count_visits': 79}, {'merchant_category': 'Wholesale Clubs', 'count_visits': 78}, {'merchant_category': 'Drug Stores and Pharmacies', 'count_visits': 72}], 'spending_summary': [{'spending_category': 'Low', 'count_trxn': 62}, {'spending_category': 'Medium', 'count_trxn': 158}, {'spending_category': 'High', 'count_trxn': 284}], 'cluster_user': 2, 'user_profile_info': {'age_group': '40–98', 'annual_income': 'Low to moderate (600–67k) in USD', 'total_debt': 'Low to moderate (0–30k) in USD', 'spending_amount_category': 'Low to moderate (1–160) in USD', 'profile_summary': 'Older individuals with low income and low debt.'}}"}], 'model': 'gpt-4o-mini'}}
DEBUG:openai._base_client:Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
DEBUG:httpcore.connection:connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
DEBUG:httpcore.connection:connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000027119094E50>
DEBUG:httpcore.connection:start_tls.started ssl_context=<ssl.SSLContext object at 0x00000271190FE240> server_hostname='api.openai.com' timeout=5.0
DEBUG:httpcore.connection:start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000027119094EE0>
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 15 Jan 2025 14:08:10 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'startt-media'), (b'openai-processing-ms', b'5479'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'200000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'199127'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'261ms'), (b'x-request-id', b'req_39a920c6bee642e333d24bbd88567f1e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=3E7YfliNaalCI_S2nMJbs_sUArLnXag3LQ7Os5unX54-1736950090-1.0.1.1-LTXKd8QsR0.Qn0LH1xP9JI5Iky3aZ3MprLhlvDwTS0yhIRBELonkXo96tg64xxiKwImv3ncAO7qGHOGcVzcYjg; path=/; expires=Wed, 15-Jan-25 14:38:10 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=gYI5uXlYFeImxP8zR4lr4qPUALQso7kmWCM1QjS476Y-1736950090960-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'90266f8d2f54937d-MAA'), (b'Content-Encoding', b'gzip')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:openai._base_client:HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Wed, 15 Jan 2025 14:08:10 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'startt-media'), ('openai-processing-ms', '5479'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '200000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '199127'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '261ms'), ('x-request-id', 'req_39a920c6bee642e333d24bbd88567f1e'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=3E7YfliNaalCI_S2nMJbs_sUArLnXag3LQ7Os5unX54-1736950090-1.0.1.1-LTXKd8QsR0.Qn0LH1xP9JI5Iky3aZ3MprLhlvDwTS0yhIRBELonkXo96tg64xxiKwImv3ncAO7qGHOGcVzcYjg; path=/; expires=Wed, 15-Jan-25 14:38:10 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=gYI5uXlYFeImxP8zR4lr4qPUALQso7kmWCM1QjS476Y-1736950090960-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '90266f8d2f54937d-MAA'), ('content-encoding', 'gzip')])
DEBUG:openai._base_client:request_id: req_39a920c6bee642e333d24bbd88567f1e
INFO:src.utils.log_file:cutomised content for user generated
INFO:src.utils.log_file:execution started for fetching client info : 104
INFO:src.utils.log_file:client info fetch completed
INFO:src.utils.log_file:getting cluser info 104
INFO:src.utils.log_file:user belongs to 2
INFO:src.utils.log_file:starting process for cutomised content for user
DEBUG:openai._base_client:Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '{\'marketing_content_instruction\': "You are an expert Marketing content creator for Banking Products and services. Use the customer data given containing user Age group, annual income, debt, spending habits to suggest them tailored banking products and services via email. In the final response suggest the marketing products and services, along with a attractive Tag Line for suggested products & services. Do not provide the summary of user income, expenses or debt in final response. Format the response in a dictionary {\'email_body\': email, \'tag_line\': Tagline}"}'}, {'role': 'user', 'content': "Generate customized marketing email using the given information: {'client_id': 104, 'sum_amount_spent': '35087.18000000001', 'count_amount_spent': '672', 'avg_amount_spent': '52.213065476190486', 'mode_spent': [{'use_chip': 'Chip Transaction', 'amount_spent': 14154.96}, {'use_chip': 'Online Transaction', 'amount_spent': 4983.15}, {'use_chip': 'Swipe Transaction', 'amount_spent': 15949.07}], 'mode_count': [{'use_chip': 'Chip Transaction', 'Num_of_transaction': 307}, {'use_chip': 'Online Transaction', 'Num_of_transaction': 45}, {'use_chip': 'Swipe Transaction', 'Num_of_transaction': 320}], 'top_n_merchants': [{'merchant_category': 'Eating Places and Restaurants', 'amount': 8912.44}, {'merchant_category': 'Fast Food Restaurants', 'amount': 4008.2}, {'merchant_category': 'Telecommunication Services', 'amount': 2628.63}], 'quarterly_spent': [{'quarter': '2019Q1', 'Amount_Spent': 9934.93}, {'quarter': '2019Q2', 'Amount_Spent': 10234.85}, {'quarter': '2019Q3', 'Amount_Spent': 10843.73}, {'quarter': '2019Q4', 'Amount_Spent': 4073.67}], 'top_n_trnxn_qtr': [{'quarter': '2019Q1', 'merchant_category': 'Eating Places and Restaurants', 'count_trnsxn': 62}, {'quarter': '2019Q1', 'merchant_category': 'Fast Food Restaurants', 'count_trnsxn': 27}, {'quarter': '2019Q1', 'merchant_category': 'Service Stations', 'count_trnsxn': 18}, {'quarter': '2019Q2', 'merchant_category': 'Eating Places and Restaurants', 'count_trnsxn': 67}, {'quarter': '2019Q2', 'merchant_category': 'Fast Food Restaurants', 'count_trnsxn': 27}, {'quarter': '2019Q2', 'merchant_category': 'Service Stations', 'count_trnsxn': 23}, {'quarter': '2019Q3', 'merchant_category': 'Eating Places and Restaurants', 'count_trnsxn': 71}, {'quarter': '2019Q3', 'merchant_category': 'Fast Food Restaurants', 'count_trnsxn': 30}, {'quarter': '2019Q3', 'merchant_category': 'Wholesale Clubs', 'count_trnsxn': 11}, {'quarter': '2019Q4', 'merchant_category': 'Eating Places and Restaurants', 'count_trnsxn': 17}, {'quarter': '2019Q4', 'merchant_category': 'Fast Food Restaurants', 'count_trnsxn': 12}, {'quarter': '2019Q4', 'merchant_category': 'Miscellaneous Food Stores', 'count_trnsxn': 6}], 'top_n_store_visits': [{'merchant_category': 'Eating Places and Restaurants', 'count_visits': 217}, {'merchant_category': 'Fast Food Restaurants', 'count_visits': 96}, {'merchant_category': 'Service Stations', 'count_visits': 51}], 'spending_summary': [{'spending_category': 'Low', 'count_trxn': 90}, {'spending_category': 'Medium', 'count_trxn': 323}, {'spending_category': 'High', 'count_trxn': 259}], 'cluster_user': 2, 'user_profile_info': {'age_group': '40–98', 'annual_income': 'Low to moderate (600–67k) in USD', 'total_debt': 'Low to moderate (0–30k) in USD', 'spending_amount_category': 'Low to moderate (1–160) in USD', 'profile_summary': 'Older individuals with low income and low debt.'}}"}], 'model': 'gpt-4o-mini'}}
DEBUG:openai._base_client:Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
DEBUG:httpcore.connection:connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
DEBUG:httpcore.connection:connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000027116E9AD40>
DEBUG:httpcore.connection:start_tls.started ssl_context=<ssl.SSLContext object at 0x00000271190FE9C0> server_hostname='api.openai.com' timeout=5.0
DEBUG:httpcore.connection:start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000027116E9AAD0>
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 15 Jan 2025 14:09:30 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'startt-media'), (b'openai-processing-ms', b'23279'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'200000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'199125'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'262ms'), (b'x-request-id', b'req_9308610cc78f5953cdbd35854ebf2382'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=YQMguq6GVd_54CHrB23_RQqPMGsgR4aPyX0Rs9n7NCQ-1736950170-1.0.1.1-v5al7K18of9GsYx0Pib8cDGhjPcdehV28alReqqpM4_RSEeh.jTHJzpfiB1hjVi_qMkQcM_nabTMPoziAPIGZQ; path=/; expires=Wed, 15-Jan-25 14:39:30 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=ISCGTfcX4KbVzAcGAv_M51Lb5mYWhZ5yQazVPDTHqjQ-1736950170796-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'90267110ebb29373-MAA'), (b'Content-Encoding', b'gzip')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:openai._base_client:HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Wed, 15 Jan 2025 14:09:30 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'startt-media'), ('openai-processing-ms', '23279'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '200000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '199125'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '262ms'), ('x-request-id', 'req_9308610cc78f5953cdbd35854ebf2382'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=YQMguq6GVd_54CHrB23_RQqPMGsgR4aPyX0Rs9n7NCQ-1736950170-1.0.1.1-v5al7K18of9GsYx0Pib8cDGhjPcdehV28alReqqpM4_RSEeh.jTHJzpfiB1hjVi_qMkQcM_nabTMPoziAPIGZQ; path=/; expires=Wed, 15-Jan-25 14:39:30 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=ISCGTfcX4KbVzAcGAv_M51Lb5mYWhZ5yQazVPDTHqjQ-1736950170796-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '90267110ebb29373-MAA'), ('content-encoding', 'gzip')])
DEBUG:openai._base_client:request_id: req_9308610cc78f5953cdbd35854ebf2382
INFO:src.utils.log_file:cutomised content for user generated
DEBUG:httpcore.connection:close.started
DEBUG:httpcore.connection:close.complete
DEBUG:httpcore.connection:close.started
DEBUG:httpcore.connection:close.complete
INFO:src.utils.log_file:execution started for fetching client info : 206
INFO:src.utils.log_file:client info fetch completed
INFO:src.utils.log_file:getting cluser info 206
INFO:src.utils.log_file:user belongs to 2
INFO:src.utils.log_file:starting process for cutomised content for user
DEBUG:openai._base_client:Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '{\'marketing_content_instruction\': "You are an expert Marketing content creator for Banking Products and services. Use the customer data given containing user Age group, annual income, debt, spending habits to suggest them tailored banking products and services via email. In the final response suggest the marketing products and services, along with a attractive Tag Line for suggested products & services based on user profile. Do not provide the summary of user income, expenses or debt in final response. Format the response in a dictionary {\'email_body\': email, \'tag_line\': Tagline}"}'}, {'role': 'user', 'content': "Generate customized marketing email using the given information: {'client_id': 206, 'sum_amount_spent': '24121.68', 'count_amount_spent': '448', 'avg_amount_spent': '53.84303571428571', 'mode_spent': [{'use_chip': 'Chip Transaction', 'amount_spent': 22201.57}, {'use_chip': 'Online Transaction', 'amount_spent': 1183.8999999999999}, {'use_chip': 'Swipe Transaction', 'amount_spent': 736.21}], 'mode_count': [{'use_chip': 'Chip Transaction', 'Num_of_transaction': 429}, {'use_chip': 'Online Transaction', 'Num_of_transaction': 11}, {'use_chip': 'Swipe Transaction', 'Num_of_transaction': 8}], 'top_n_merchants': [{'merchant_category': 'Utilities - Electric, Gas, Water, Sanitary', 'amount': 7472.45}, {'merchant_category': 'Money Transfer', 'amount': 2920.0}, {'merchant_category': 'Eating Places and Restaurants', 'amount': 1817.26}], 'quarterly_spent': [{'quarter': '2019Q1', 'Amount_Spent': 8163.34}, {'quarter': '2019Q2', 'Amount_Spent': 7071.16}, {'quarter': '2019Q3', 'Amount_Spent': 6197.29}, {'quarter': '2019Q4', 'Amount_Spent': 2689.89}], 'top_n_trnxn_qtr': [{'quarter': '2019Q1', 'merchant_category': 'Service Stations', 'count_trnsxn': 16}, {'quarter': '2019Q1', 'merchant_category': 'Miscellaneous Food Stores', 'count_trnsxn': 15}, {'quarter': '2019Q1', 'merchant_category': 'Eating Places and Restaurants', 'count_trnsxn': 14}, {'quarter': '2019Q2', 'merchant_category': 'Service Stations', 'count_trnsxn': 24}, {'quarter': '2019Q2', 'merchant_category': 'Miscellaneous Food Stores', 'count_trnsxn': 18}, {'quarter': '2019Q2', 'merchant_category': 'Utilities - Electric, Gas, Water, Sanitary', 'count_trnsxn': 13}, {'quarter': '2019Q3', 'merchant_category': 'Service Stations', 'count_trnsxn': 27}, {'quarter': '2019Q3', 'merchant_category': 'Miscellaneous Food Stores', 'count_trnsxn': 17}, {'quarter': '2019Q3', 'merchant_category': 'Money Transfer', 'count_trnsxn': 13}, {'quarter': '2019Q4', 'merchant_category': 'Eating Places and Restaurants', 'count_trnsxn': 5}, {'quarter': '2019Q4', 'merchant_category': 'Grocery Stores, Supermarkets', 'count_trnsxn': 4}, {'quarter': '2019Q4', 'merchant_category': 'Fast Food Restaurants', 'count_trnsxn': 3}], 'top_n_store_visits': [{'merchant_category': 'Service Stations', 'count_visits': 69}, {'merchant_category': 'Miscellaneous Food Stores', 'count_visits': 53}, {'merchant_category': 'Money Transfer', 'count_visits': 40}], 'spending_summary': [{'spending_category': 'Low', 'count_trxn': 103}, {'spending_category': 'Medium', 'count_trxn': 152}, {'spending_category': 'High', 'count_trxn': 193}], 'cluster_user': 2, 'user_profile_info': {'age_group': '40–98', 'annual_income': 'Low to moderate (600–67k) in USD', 'total_debt': 'Low to moderate (0–30k) in USD', 'spending_amount_category': 'Low to moderate (1–160) in USD', 'profile_summary': 'Older individuals with low income and low debt.'}}"}], 'model': 'gpt-4o-mini'}}
DEBUG:openai._base_client:Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
DEBUG:httpcore.connection:connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
DEBUG:httpcore.connection:connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002CA2D088E50>
DEBUG:httpcore.connection:start_tls.started ssl_context=<ssl.SSLContext object at 0x000002CA2D0F2240> server_hostname='api.openai.com' timeout=5.0
DEBUG:httpcore.connection:start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002CA2D088EE0>
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 15 Jan 2025 14:10:25 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'startt-media'), (b'openai-processing-ms', b'5789'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'200000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'199117'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'264ms'), (b'x-request-id', b'req_df8328e389d6cfe842599aebdb8b7831'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=Pdz2iqb11Edxu6vin8ooME0qyHkPvDu3pb0MVf6144c-1736950225-1.0.1.1-B5shfKFxPOZn01Xzf3chV_49cZYsIWeSsAtVvMmxN.a5NwtlnFYj5RJgRNz5feDwMStri3xDM4.sLzk7EtIiOA; path=/; expires=Wed, 15-Jan-25 14:40:25 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=Bv4YeEZHu4sv_XglJHo7iW3THe68gauGLDfWY5lOZOM-1736950225616-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'902672d858708004-MAA'), (b'Content-Encoding', b'gzip')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:openai._base_client:HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Wed, 15 Jan 2025 14:10:25 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'startt-media'), ('openai-processing-ms', '5789'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '200000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '199117'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '264ms'), ('x-request-id', 'req_df8328e389d6cfe842599aebdb8b7831'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=Pdz2iqb11Edxu6vin8ooME0qyHkPvDu3pb0MVf6144c-1736950225-1.0.1.1-B5shfKFxPOZn01Xzf3chV_49cZYsIWeSsAtVvMmxN.a5NwtlnFYj5RJgRNz5feDwMStri3xDM4.sLzk7EtIiOA; path=/; expires=Wed, 15-Jan-25 14:40:25 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=Bv4YeEZHu4sv_XglJHo7iW3THe68gauGLDfWY5lOZOM-1736950225616-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '902672d858708004-MAA'), ('content-encoding', 'gzip')])
DEBUG:openai._base_client:request_id: req_df8328e389d6cfe842599aebdb8b7831
INFO:src.utils.log_file:cutomised content for user generated
DEBUG:httpcore.connection:close.started
DEBUG:httpcore.connection:close.complete
INFO:src.utils.log_file:execution started for fetching client info : 208
INFO:src.utils.log_file:client info fetch completed
INFO:src.utils.log_file:getting cluser info 208
ERROR:src.utils.log_file:Something went wrong in getting cluster id [Errno 2] No such file or directory: '\\case_study_cba\\src\\model\\gmm_model.pkl'
INFO:src.utils.log_file:starting process for cutomised content for user
ERROR:src.utils.log_file:Error occured 'NA'
INFO:src.utils.log_file:execution started for fetching client info : 208
INFO:src.utils.log_file:client info fetch completed
INFO:src.utils.log_file:getting cluser info 208
INFO:src.utils.log_file:user belongs to 2
INFO:src.utils.log_file:starting process for cutomised content for user
DEBUG:openai._base_client:Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '{\'marketing_content_instruction\': "You are an expert Marketing content creator for Banking Products and services. Use the customer data given containing user Age group, annual income, debt, spending habits to suggest them tailored banking products and services via email. In the final response suggest the marketing products and services, along with a attractive Tag Line for suggested products & services based on user profile. Do not provide the summary of user income, expenses or debt in final response. Format the response in a dictionary {\'email_body\': email, \'tag_line\': Tagline}"}'}, {'role': 'user', 'content': "Generate customized marketing email using the given information: {'client_id': 208, 'sum_amount_spent': '96824.73999999999', 'count_amount_spent': '2551', 'avg_amount_spent': '37.955601724813796', 'mode_spent': [{'use_chip': 'Chip Transaction', 'amount_spent': 77660.73}, {'use_chip': 'Online Transaction', 'amount_spent': 11594.05}, {'use_chip': 'Swipe Transaction', 'amount_spent': 7569.96}], 'mode_count': [{'use_chip': 'Chip Transaction', 'Num_of_transaction': 2197}, {'use_chip': 'Online Transaction', 'Num_of_transaction': 207}, {'use_chip': 'Swipe Transaction', 'Num_of_transaction': 147}], 'top_n_merchants': [{'merchant_category': 'Service Stations', 'amount': 25100.94}, {'merchant_category': 'Miscellaneous Food Stores', 'amount': 21328.92}, {'merchant_category': 'Taxicabs and Limousines', 'amount': 9539.79}], 'quarterly_spent': [{'quarter': '2019Q1', 'Amount_Spent': 27697.8}, {'quarter': '2019Q2', 'Amount_Spent': 29491.19}, {'quarter': '2019Q3', 'Amount_Spent': 29833.2}, {'quarter': '2019Q4', 'Amount_Spent': 9802.55}], 'top_n_trnxn_qtr': [{'quarter': '2019Q1', 'merchant_category': 'Service Stations', 'count_trnsxn': 247}, {'quarter': '2019Q1', 'merchant_category': 'Miscellaneous Food Stores', 'count_trnsxn': 226}, {'quarter': '2019Q1', 'merchant_category': 'Taxicabs and Limousines', 'count_trnsxn': 76}, {'quarter': '2019Q2', 'merchant_category': 'Service Stations', 'count_trnsxn': 290}, {'quarter': '2019Q2', 'merchant_category': 'Miscellaneous Food Stores', 'count_trnsxn': 248}, {'quarter': '2019Q2', 'merchant_category': 'Taxicabs and Limousines', 'count_trnsxn': 86}, {'quarter': '2019Q3', 'merchant_category': 'Service Stations', 'count_trnsxn': 301}, {'quarter': '2019Q3', 'merchant_category': 'Miscellaneous Food Stores', 'count_trnsxn': 227}, {'quarter': '2019Q3', 'merchant_category': 'Taxicabs and Limousines', 'count_trnsxn': 73}, {'quarter': '2019Q4', 'merchant_category': 'Service Stations', 'count_trnsxn': 87}, {'quarter': '2019Q4', 'merchant_category': 'Miscellaneous Food Stores', 'count_trnsxn': 83}, {'quarter': '2019Q4', 'merchant_category': 'Taxicabs and Limousines', 'count_trnsxn': 22}], 'top_n_store_visits': [{'merchant_category': 'Service Stations', 'count_visits': 925}, {'merchant_category': 'Miscellaneous Food Stores', 'count_visits': 784}, {'merchant_category': 'Taxicabs and Limousines', 'count_visits': 257}], 'spending_summary': [{'spending_category': 'Low', 'count_trxn': 683}, {'spending_category': 'Medium', 'count_trxn': 499}, {'spending_category': 'High', 'count_trxn': 1369}], 'cluster_user': 2, 'user_profile_info': {'age_group': '40–98', 'annual_income': 'Low to moderate (600–67k) in USD', 'total_debt': 'Low to moderate (0–30k) in USD', 'spending_amount_category': 'Low to moderate (1–160) in USD', 'profile_summary': 'Older individuals with low income and low debt.'}}"}], 'model': 'gpt-4o-mini'}}
DEBUG:openai._base_client:Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
DEBUG:httpcore.connection:connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
DEBUG:httpcore.connection:connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002891D244E80>
DEBUG:httpcore.connection:start_tls.started ssl_context=<ssl.SSLContext object at 0x000002891D33A240> server_hostname='api.openai.com' timeout=5.0
DEBUG:httpcore.connection:start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002891D244F10>
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 15 Jan 2025 15:06:38 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'startt-media'), (b'openai-processing-ms', b'7521'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'200000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'199123'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'263ms'), (b'x-request-id', b'req_551e61893848ae10eb61adbb324376e2'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=OYzslR0KA_y8E4BI4NUcJhMlOkGge7xjrR2n0QUNJ7w-1736953598-1.0.1.1-1t2bTqAGuxEwPuw_SSYjVipvjNYfJSsBzgBlrLFD5ZeYYm4xJuiB0_gjRRvxmLC6ZXRdJiaQ6P.mDwbARaNFOw; path=/; expires=Wed, 15-Jan-25 15:36:38 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=IUFdyYmrGY__05A1SljixqiwlGk1OfGk_TbgQ1tyvZY-1736953598096-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9026c5239ede8013-MAA'), (b'Content-Encoding', b'gzip')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:openai._base_client:HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Wed, 15 Jan 2025 15:06:38 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'startt-media'), ('openai-processing-ms', '7521'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '200000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '199123'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '263ms'), ('x-request-id', 'req_551e61893848ae10eb61adbb324376e2'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=OYzslR0KA_y8E4BI4NUcJhMlOkGge7xjrR2n0QUNJ7w-1736953598-1.0.1.1-1t2bTqAGuxEwPuw_SSYjVipvjNYfJSsBzgBlrLFD5ZeYYm4xJuiB0_gjRRvxmLC6ZXRdJiaQ6P.mDwbARaNFOw; path=/; expires=Wed, 15-Jan-25 15:36:38 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=IUFdyYmrGY__05A1SljixqiwlGk1OfGk_TbgQ1tyvZY-1736953598096-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '9026c5239ede8013-MAA'), ('content-encoding', 'gzip')])
DEBUG:openai._base_client:request_id: req_551e61893848ae10eb61adbb324376e2
INFO:src.utils.log_file:cutomised content for user generated
DEBUG:httpcore.connection:close.started
DEBUG:httpcore.connection:close.complete
